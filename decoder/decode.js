var encodedPayload = `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`
var encodingKey = `kyxg`
var encodedPayloadBytes = []
var encodedPayloadAtob = atob(encodedPayload)
for(var i = 0; i < encodedPayloadAtob.length; i++) {
    encodedPayloadBytes.push(encodedPayloadAtob.charCodeAt(i))
}


encodingKey = reverseString(encodingKey)
encodingKey = encodingKey + encodeXORKey(encodingKey)
console.log(encodingKey)

var output = []
for(var i = 0; i < encodedPayloadBytes.length; i++) {
    output.push(encodedPayloadBytes[i] ^ encodingKey.charCodeAt(i % encodingKey.length))
}


// convert output to string
var outputString = String.fromCharCode(...output)
console.log(outputString)


function encodeXORKey(key){
    var output = [];
    for(var i = 0; i < 4; i++) {
        var charPos = 0;
        var keyPos = 1;
        if(i === 3) {
            keyPos = 1 + key.length % 4
        }
        for(var  x = 0; x < keyPos; x++) {
            var charCodePos = i + x;
            if (x < key.length) {
                charPos = charPos + key.charCodeAt(charCodePos)
            }
        }
        charPos = charPos * 31;
        output.push("abcdhijkxy".charAt(charPos % 10))
    }
    return output.join("")
}

function reverseString(str) {
    return str.split("").reverse().join("")
}